# -*- coding: utf-8 -*-
"""
Created on Fri Nov  6 10:29:02 2020

@author: wantysal
"""

import numpy as np


def gzi_definition(center_freq):
    """ Weighting function for the specific roughness given by Aures
    
    Linear interpolation from the data given in E. Zwicker, H. Fastl: Psychoacoustics, 1990 """
    # psysound v1
    # gr_x = [ 0,1,2.5,4.9,6.5,8,9,10,11,11.5,13,17.5,21,24]        
    # gr_y = [ 0,0.35,0.7,0.7,1.1,1.25,1.26,1.18,1.08,1,0.66,0.46,0.38,0.3]
    
    # psysound v2
    # gr_x = np.arange(0,25,1)        
    # gr_y = np.array(
    #     [ 0.15, 0.26, 0.38, 0.47, 0.54, 0.65, 0.76, 0.83, 0.90, 0.98, 0.98, 0.90, 
    #       0.80, 0.70, 0.62, 0.54, 0.49, 0.43, 0.39, 0.35, 0.30, 0.30, 0.30, 0.30, 0.30 ]
    #     )
    
    # # # Fastl
    gr_x = np.array(
        [ 0.02415459,  1.0096618 ,  2.0241547 ,  3.009662  ,  4.0241547 ,
          4.995169  ,  6.0241547 ,  7.0096617 ,  7.995169  ,  9.009662  ,
          10.009662 , 11.009662  , 12.009662  , 13.009662  , 14.024155  ,
          14.995169 , 15.995169  , 17.024155  , 18.024155  , 19.009663  ,
          20.009663 , 20.980677  , 22.009663  , 22.995169  , 23.995169  ]
        ) 
    
    gr_y = np.array(
        [0.50006914, 0.50152147, 0.54944676, 0.6031812 , 0.68160444,
         0.7440525 , 0.8021439 , 0.8558783 , 0.9517289 , 1.0533887 ,
         1.1216459 , 1.1753803 , 1.1608576 , 1.1027663 , 1.0025588 ,
         0.9023513 , 0.82392806, 0.76002765, 0.74260026, 0.70193636,
         0.684509  , 0.684509  , 0.6830567 , 0.68160444, 0.68160444]
        )
                        
    gzi = np.sqrt(np.interp(center_freq, gr_x, gr_y))
             
    return gzi