# -*- coding: utf-8 -*-
"""
Created on Fri Nov  6 10:29:02 2020

@author: wantysal
"""

import numpy as np


def gzi_definition(center_freq):
    """ Weighting function for the specific roughness given by Aures
    
    Linear interpolation from the data given in E. Zwicker, H. Fastl: Psychoacoustics, 1990 """
    # psysound v1
    # gr_x = [ 0,1,2.5,4.9,6.5,8,9,10,11,11.5,13,17.5,21,24]
        
    # gr_y = [ 0,0.35,0.7,0.7,1.1,1.25,1.26,1.18,1.08,1,0.66,0.46,0.38,0.3]
    
    gr_x = np.array([ 0.       ,  0.994805 ,  0.993951 ,  1.99716  ,  2.02203  ,
        2.9738   ,  2.99817  ,  3.97569  ,  3.97462  ,  5.0035267,
        5.00281  ,  5.980301 ,  5.9793634,  7.0083013,  7.006592 ,
        7.9839997,  8.007601 ,  9.010759 ,  8.958458 , 10.013091 ,
        10.012457 , 10.964225 , 10.964583 , 11.942046 , 11.994375 ,
        12.971867 , 12.973189 , 13.950681 , 13.977976 , 14.98119  ,
        14.982844 , 15.960362 , 15.961135 , 16.938625 , 16.990734 ,
        17.942556 , 17.968748 , 18.972017 , 18.997963 , 23.962559 ])
    
    gr_y = np.array([0.499318, 0.499386, 0.550137, 0.550205, 0.600957, 0.601022,
        0.681242, 0.679672, 0.743519, 0.745226, 0.787791, 0.787858,
        0.843519, 0.84359 , 0.94509 , 0.950068, 1.07613 , 1.07947 ,
        1.13022 , 1.13193 , 1.16958 , 1.16964 , 1.14836 , 1.15007 ,
        1.09768 , 1.09775 , 1.01917 , 1.01923 , 0.92592 , 0.925989,
        0.827762, 0.826192, 0.780353, 0.78042 , 0.741133, 0.737923,
        0.710094, 0.706888, 0.693793, 0.695769])
    # psysound v2
    # gr_x = np.arange(0,25,1)
        
    # gr_y = np.array(
    #     [ 0.15, 0.26, 0.38, 0.47, 0.54, 0.65, 0.76, 0.83, 0.90, 0.98, 0.98, 0.90, 
    #       0.80, 0.70, 0.62, 0.54, 0.49, 0.43, 0.39, 0.35, 0.30, 0.30, 0.30, 0.30, 0.30 ]
    #         )
                        
    gzi = np.sqrt(np.interp(center_freq, gr_x, gr_y))
             
    return gzi