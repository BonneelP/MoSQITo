# -*- coding: utf-8 -*-
"""
Created on Thu Nov  5 17:32:06 2020

@author: wantysal
"""

import numpy as np
    
def LTQ(bark_axis):
    """Calculate the level threshold in quiet over frequency axis in Hz
    
    Linear interpolation from the data given in E. Zwicker, H. Fastl:
    Psychoacoustics. Springer, Berlin, Heidelberg, 1990.
    SPL is given for a free-field condition relative to 2 × 10−5 Pa
    """
    
    # Make list of minimum excitation (Hearing Treshold)
    
    # HTres_x = np.array([2.14601870e-04, 3.63744400e-04, 6.39055300e-04, 1.44266070e-03,
    #     2.72333000e-03, 9.03682100e-03, 2.15357140e-02, 5.27304940e-02,
    #     1.31465580e-01, 4.81839520e-01, 1.09858345e+00, 2.03818880e+00,
    #     3.10486500e+00, 4.44215450e+00, 5.29842500e+00, 6.64685143e+00,
    #     8.75389250e+00, 1.02787635e+01, 1.23635931e+01, 1.40925578e+01,
    #     1.67042728e+01, 1.82107075e+01, 1.96492680e+01, 2.07969469e+01,
    #     2.14907319e+01, 2.19342390e+01, 2.26066350e+01, 2.28788680e+01,
    #     2.32081650e+01, 2.32877867e+01, 2.34889277e+01, 2.34525613e+01,
    #     2.35888842e+01, 2.38211345e+01, ])

    # HTres_y = np.array([ 70.21553   ,  60.517204  ,  51.177113  ,  40.277622  ,
    #     32.491344  ,  20.987085  ,  14.153728  ,   9.353435  ,
    #       6.107884  ,   3.4537597 ,   2.3629107 ,   0.67753327,
    #     -1.24367   ,  -3.403026  ,  -4.4831696 ,  -4.3683596 ,
    #     -2.2215705 ,   0.40586832,   3.1516855 ,   4.941478  ,
    #       6.8484077 ,   8.757819  ,  11.743651  ,  14.850034  ,
    #     18.19705   ,  23.099741  ,  30.154808  ,  41.397793  ,
    #     50.128616  ,  58.62129   ,  69.38626   ,  77.8794    ,
    #     85.654045  , 138.8438    ])

    HTres_x = np.array([2.00e-02, 3.08064020e-02, 8.00e-01, 1.00e+00, 1.50e+00,
                        2.00e+00, 3.30e+00, 4.00e+00, 5.00e+00, 6.00e+00, 8.00e+00,
                        1.00e+01, 1.20e+01, 1.33e+01, 1.50e+01, 1.60e+01, 1.70e+01,
                        1.80e+01, 1.90e+01, 2.00e+01, 2.10e+01, 2.20e+01, 2.30e+01,
                        2.40e+01, 2.45e+01, 2.50e+01])
    
    HTres_y = np.array([70. ,  60.30403 ,  30. ,  25. ,  20. ,  15. ,  10. ,   8.1,
                          6.3,   5. ,   3.5,   2.5,   1.7,   0. ,  -2.5,  -4. ,  -3.7,
                        -1.5,   1.4,   3.8,   5. ,   7.5,  15. ,  48. ,  60. , 130. ])
       
    MinExcdB = np.interp(bark_axis,HTres_x,HTres_y)
        
    return MinExcdB 